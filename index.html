<!doctype html>
<html lang="en" class="h-100">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="un Violence VIS">
    <meta name="author" content="Chunyu Chen, Danrui Qi, Jiuwei Wang">

    <title>GUN VIOLENCE VIS</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="./core/css/bootstrap.min.css" type="text/css" />


    <meta name="theme-color" content="#7952b3">


    <!-- Custom styles for this template -->
    <link rel="stylesheet" type="text/css" href="./core/css/style.css">




</head>

<body class="d-flex h-100 text-center text-white bg-dark">

    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
        <!-- cover-container d-flex w-100 h-100 p-3 mx-auto flex-column -->
        <header class="mb-5">
            <div>
                <nav class="nav nav-masthead justify-content-center float-md-end">
                    <h3 class="float-md-start mb-0">GUN VIOLENCE VIS</h3>
                    <!-- <a class="nav-link active" aria-current="page" href="#">Home</a>
                    <a class="nav-link" href="#">Features</a>
                    <a class="nav-link" href="#">Contact</a> -->
                </nav>
            </div>
        </header>

        <main class="main" role="main">
            <div class="row w-100 justify-content-md-center">
                <!-- <div class="row justify-content-md-center bg-dark"> -->
                <div class="col col-2 ">
                    <div id="peoplebox" id = "peopletotalcount" class="peoplebox" data-toggle="tooltip" 
                        data-placement="bottom" data-html="true" title="<div><em>Male:</em> <b><div id='tooltiptotalcount'></div></b> <br> <em>Female:</em> <b><div id='tooltiptotalfemalecount'></div></b></div>">
                        <span id="peoplelabel" onselectstart="return false;">PEOPLE INVOLVED:</span>
                        <br>
                        <span class="peoplecount" id="peoplecount" >0</span>
                        <span class="progress progress-bar-vertical">
                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-secondary" id="progresstotalcount" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" >
                            </div>
                        </span>
                        
                    </div>
                </div>
                <div class="col col-2 ">
                    <div id="peoplebox" class="peoplebox" data-toggle="tooltip" 
                    data-placement="bottom" data-html="true" title="<div><em>Male:</em> <b><div id='tooltipkilledcount'></div></b> <br> <em>Female:</em> <b><div id='tooltipkilledfemalecount'></div></b></div>">
                        <span id="peoplekilledlabel" onselectstart="return false;">PEOPLE KILLED:</span>
                        <br>
                        <span id="peoplekilledcount">0</span>

                        <span class="progress progress-bar-vertical">
                            <span class="progress-bar progress-bar-striped progress-bar-animated bg-danger" id="progresskilledcount" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                            </span>
                        </span>
                    </div>
            

                </div>
                <div class="col col-2">

                    <div id="peoplebox" class="peoplebox" data-toggle="tooltip" 
                    data-placement="bottom" data-html="true" title="<div><em>Male:</em> <b><div id='tooltipinjuredcount'></div></b> <br> <em>Female:</em> <b><div id='tooltipinjuredfemalecount'></div></b></div>">
                        <span id="peopleinjuredlabel" onselectstart="return false;">PEOPLE INJURED:</span>
                        <br>
                      
                        <span id="peopleinjuredcount" >0</span>                  
                        <span class="progress progress-bar-vertical">
                            <span class="progress-bar progress-bar-striped progress-bar-animated bg-warning" id="progressinjuredcount" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                             
                            </span>
                        </span>
                      

                        <!-- <a href="#" data-toggle="popover" title="Popover Header" data-content="Some content inside the popover">Toggle popover</a> -->
                    </div>
                </div>
            </div>
            <!-- US MAP  -->
            <div class="row justify-content-md-center">
                <!-- <div class="col col-md-10 bg-light"> -->
                <div class="uStates"></div>
                <!-- </div> -->
            </div>
            <!-- Date Line  -->
            <div class="row justify-content-md-center">
                <div class="col col-md-10">
                    <div class="progress-scrubber">
                        <form class="progress-form">
                            <button id="progress-status-btn" class="progress-status-btn" name="b" type="button"
                                style="margin-right: 0.4em; width: 4em;"></button>
                            <label style="display: flex; align-items: center; width: 100%;">
                                <input type="range" min=0 max=755 value=12 step=1 class="progress-input"
                                    id="progress-input" ">
                              <output style=" margin-left: 0.4em;" id="progress-output"></output>
                            </label>
                        </form>
                    </div>

                </div>

            </div>
        </main>

        <footer class="mt-auto text-white-50 fixed-bottom">

            <div class="btn-group" role="group" aria-label="Basic example">
                
                <a href="/index.html" class="btn btn-secondary btn-sm active" role="button" aria-pressed="true">Distribution</a>
                <a href="/index-4.html" class="btn btn-secondary btn-sm " role="button" aria-pressed="true">Trends</a>
                <a href="/index-2.html" class="btn btn-secondary btn-sm " role="button" aria-pressed="true">Suspect</a>
                <!-- <button type="button" class="btn btn-primary">Left</button>
                <button type="button" class="btn btn-primary">Middle</button>
                <button type="button" class="btn btn-primary">Right</button> -->
            </div>

            <p>CMPT 767 Visualization template for <a href="https://getbootstrap.com/" class="text-white">GUN
                    VIOLENCE</a>, by <a href="#" class="text-white">@Chunyu Chen</a>,<a href="#"
                    class="text-white">@Danrui Qi</a>,<a href="#" class="text-white">@Jiuwei Wang</a>.</p>
        </footer>
    </div>



</body>


<script type="text/javascript" src="./core/js/jquery-2.2.3.min.js"></script>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="http://d3js.org/topojson.v3.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

<script type="text/javascript" src="./core/css/bootstrap-4.6.0-dist/js/bootstrap.bundle.js"></script>
<!-- <script type="text/javascript" src="./core/js/bootstrap.min.js"></script> -->

<script type="text/javascript" src="./core/js/gun-violence-vis.js"></script>
<script type="text/javascript" src="./core/js/scrubber.js"></script>

<script>
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
        // $('#peopletotalcount').tooltip()
    })
    
    function title(){
        return 'title'
    }
    function content(){
        return 'content'
    }

    async function drawUsMap() {
        const us = await d3.json("/core/us-counties.topojson")
        chart = us_chart(us)
        return chart
    }


    async function loadData(chart) {
        // const us = await d3.json("/core/us-counties.topojson")
        const gun = await d3.csv("/datasets/gun.csv")
        return gun
    }

    drawUsMap().then(chart => {
        var parseTime = d3.timeParse("%Y-%m-%d");
        var start = parseTime("2013-01-01")
        var end = parseTime("2018-03-31")
        const span = d3.timeDay.every(4).range(start, end)
        date = Scrubber(span, { format: d3.timeFormat("%Y-%m-%d"), loop: false })

        loadData(chart).then(gun => {

            /* draw the gun violence event on the map */
            gun_events_chart = gun_violence_chart(chart, gun)
            document.getElementById('progress-input').addEventListener('input', function (e) {
                let date = document.getElementById('progress-output').value
                updatePeopleCount(gun, date)
                gun_events_chart.update(date)
            });

            // new Scrubbing ( document.querySelector ( '#peoplecount') );

        })
    })

</script>


</html>