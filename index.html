<!doctype html>
<html lang="en" class="h-100">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="un Violence VIS">
    <meta name="author" content="Chunyu Chen, Danrui Qi, Jiuwei Wang">

    <title>GUN VIOLENCE VIS</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="./core/css/bootstrap.min.css" type="text/css" />


    <meta name="theme-color" content="#7952b3">


    <!-- Custom styles for this template -->
    <link rel="stylesheet" type="text/css" href="./core/css/style.css">




</head>

<body class="d-flex h-100 text-center text-white bg-dark">

    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
        <!-- cover-container d-flex w-100 h-100 p-3 mx-auto flex-column -->
        <header class="mb-5">
            <div>
                <nav class="nav nav-masthead justify-content-center float-md-end">
                    <h3 class="float-md-start mb-0">GUN VIOLENCE VIS</h3>
                    <!-- <a class="nav-link active" aria-current="page" href="#">Home</a>
                    <a class="nav-link" href="#">Features</a>
                    <a class="nav-link" href="#">Contact</a> -->
                </nav>
            </div>
        </header>

        <main class="main" role="main">
            <div class="row w-100">
                <!-- <div class="row justify-content-md-center bg-dark"> -->
                <div class="col col-md-2 offset-md-3 ">
                    <div id="peoplebox" class="peoplebox">
                        <span id="peoplecount" onselectstart="return false;">11,356</span>
                        <br>
                        <span id="peoplelabel" onselectstart="return false;">PEOPLE INVOLVED</span>
                    </div>
                </div>
                <div class="col col-md-2">

                </div>
                <div class="col col-lg-2">
                    <div id="peoplebox" class="peoplebox">
                        <span id="peoplekilledcount" onselectstart="return false;">11,356</span>
                        <br>
                        <span id="peoplekilledlabel" onselectstart="return false;">PEOPLE KILLED</span>
                    </div>
                </div>
            </div>
            <!-- US MAP  -->
            <div class="row justify-content-md-center">
                <!-- <div class="col col-md-10 bg-light"> -->
                <div class="uStates"></div>
                <!-- </div> -->
            </div>
            <!-- Date Line  -->
            <div class="row justify-content-md-center">
                <div class="col col-md-10">
                    <div class="progress-scrubber">
                        <form class="progress-form">
                            <button id="progress-status-btn" class="progress-status-btn" name="b" type="button"
                                style="margin-right: 0.4em; width: 4em;"></button>
                            <label style="display: flex; align-items: center; width: 100%;">
                                <input type="range" min=0 max=755 value=12 step=1 class="progress-input"
                                    id="progress-input" ">
                              <output style=" margin-left: 0.4em;" id="progress-output"></output>
                            </label>
                        </form>
                    </div>

                </div>

            </div>
        </main>

        <footer class="mt-auto text-white-50 fixed-bottom">
            <p>CMPT 767 Visualization template for <a href="https://getbootstrap.com/" class="text-white">GUN
                    VIOLENCE</a>, by <a href="#" class="text-white">@Chunyu Chen</a>,<a href="#"
                    class="text-white">@Danrui Qi</a>,<a href="#" class="text-white">@Jiuwei Wang</a>.</p>
        </footer>
    </div>



</body>


<script type="text/javascript" src="./core/js/jquery-2.2.3.min.js"></script>
<!-- <script type="text/javascript" src="./core/js/d3.min.js"></script> -->

<!-- <script src="http://d3js.org/d3.v3.min.js"></script> -->
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://d3js.org/d3-queue.v3.min.js"></script>
<!-- <script src="http://d3js.org/queue.v1.min.js"></script> -->
<script src="http://d3js.org/topojson.v3.min.js"></script>

<script type="text/javascript" src="./core/js/bootstrap.min.js"></script>
<script type="text/javascript" src="./core/js/papaparse.min.js"></script>
<script type="text/javascript" src="./core/js/gun-violence-vis.js"></script>
<script type="text/javascript" src="./core/js/scrubber.js"></script>

<script>
    async function drawUsMap() {
        const us = await d3.json("/core/us-counties.topojson")
        chart = us_chart(us)
        return chart
    }


    async function loadData(chart) {
        // const us = await d3.json("/core/us-counties.topojson")
        const gun = await d3.csv("/datasets/gun.csv")
        return gun
    }
    drawUsMap().then(chart => {
        loadData(chart).then(gun => {
            var parseTime = d3.timeParse("%Y-%m-%d");
            var start = parseTime("2013-01-01")
            var end = parseTime("2018-03-31")
            const span = d3.timeDay.every(4).range(start, end)
            date = Scrubber(span, { format: d3.timeFormat("%Y-%m-%d"), loop: false })
            gun_events_chart = gun_violence_chart(chart, gun)
            document.getElementById('progress-input').addEventListener('input', function (e) {
                let date = document.getElementById('progress-output').value
                gun_events_chart.update(date)
            });

        })
    })

</script>


</html>